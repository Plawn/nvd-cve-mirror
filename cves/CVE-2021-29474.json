{
  "id": "CVE-2021-29474",
  "assigner": "security-advisories@github.com",
  "Published": "2021-04-26T20:15:08.9Z",
  "Modified": "2022-10-24T16:21:13.107Z",
  "last-modified": "2022-10-24T16:21:13.107Z",
  "summary": "HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker can read arbitrary `.md` files from the server's filesystem due to an improper input validation, which results in the ability to perform a relative path traversal. To verify if you are affected, you can try to open the following URL: `http://localhost:3000/..%2F..%2FREADME#` (replace `http://localhost:3000` with your instance's base-URL e.g. `https://demo.hedgedoc.org/..%2F..%2FREADME#`). If you see a README page being rendered, you run an affected version. The attack works due the fact that the internal router passes the url-encoded alias to the `noteController.showNote`-function. This function passes the input directly to findNote() utility function, that will pass it on the the parseNoteId()-function, that tries to make sense out of the noteId/alias and check if a note already exists and if so, if a corresponding file on disk was updated. If no note exists the note creation-function is called, which pass this unvalidated alias, with a `.md` appended, into a path.join()-function which is read from the filesystem in the follow up routine and provides the pre-filled content of the new note. This allows an attacker to not only read arbitrary `.md` files from the filesystem, but also observes changes to them. The usefulness of this attack can be considered limited, since mainly markdown files are use the file-ending `.md` and all markdown files contained in the hedgedoc project, like the README, are public anyway. If other protections such as a chroot or container or proper file permissions are in place, this attack's usefulness is rather limited. On a reverse-proxy level one can force a URL-decode, which will prevent this attack because the router will not accept such a path.",
  "access": {
    "authentication": "NONE",
    "complexity": "LOW",
    "vector": "NETWORK"
  },
  "impact": {
    "availability": "NONE",
    "confidentiality": "PARTIAL",
    "integrity": "NONE"
  },
  "cvss": 5.0,
  "exploitabilityScore": 10.0,
  "impactScore": 2.9,
  "cvss-vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
  "references": [
    "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-p528-555r-pf87"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:a:hedgedoc:hedgedoc:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.3.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.3.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.5:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.6:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.5.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.2.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.2:*:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:a:hedgedoc:hedgedoc:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.3.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.3.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.5:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.4.6:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:0.5.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.2.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.3.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:hedgedoc:hedgedoc:1.7.2:*:*:*:*:*:*:*"
  ],
  "vendors": [
    "hedgedoc"
  ],
  "products": [
    "hedgedoc"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:a:hedgedoc:hedgedoc"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:a:hedgedoc:hedgedoc"
  ],
  "cwe": "CWE-22",
  "vulnerable_configuration_cpe_2_2": []
}