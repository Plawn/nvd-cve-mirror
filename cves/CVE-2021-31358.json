{
  "id": "CVE-2021-31358",
  "assigner": "sirt@juniper.net",
  "Published": "2021-10-19T17:15:09.013Z",
  "Modified": "2022-10-24T16:44:06.173Z",
  "last-modified": "2022-10-24T16:44:06.173Z",
  "summary": "A command injection vulnerability in sftp command processing on Juniper Networks Junos OS Evolved allows an attacker with authenticated CLI access to be able to bypass configured access protections to execute arbitrary shell commands within the context of the current user. The vulnerability allows an attacker to bypass command authorization restrictions assigned to their specific user account and execute commands that are available to the privilege level for which the user is assigned. For example, a user that is in the super-user login class, but restricted to executing specific CLI commands could exploit the vulnerability to execute any other command available to an unrestricted admin user. This vulnerability does not increase the privilege level of the user, but rather bypasses any CLI command restrictions by allowing full access to the shell. This issue affects Juniper Networks Junos OS Evolved: All versions prior to 20.4R2-S2-EVO; 21.1 versions prior to 21.1R2-EVO; 21.2 versions prior to 21.2R1-S1-EVO, 21.2R2-EVO.",
  "access": {
    "authentication": "NONE",
    "complexity": "LOW",
    "vector": "LOCAL"
  },
  "impact": {
    "availability": "COMPLETE",
    "confidentiality": "COMPLETE",
    "integrity": "COMPLETE"
  },
  "cvss": 7.2,
  "exploitabilityScore": 3.9,
  "impactScore": 10.0,
  "cvss-vector": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
  "references": [
    "https://kb.juniper.net/JSA11221"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:o:juniper:junos_os_evolved:18.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r2:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:o:juniper:junos_os_evolved:18.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r2:*:*:*:*:*:*"
  ],
  "vendors": [
    "juniper"
  ],
  "products": [
    "junos_os_evolved"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:o:juniper:junos_os_evolved"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:o:juniper:junos_os_evolved"
  ],
  "cwe": "CWE-78",
  "vulnerable_configuration_cpe_2_2": []
}