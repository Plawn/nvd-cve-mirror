{
  "id": "CVE-2021-32803",
  "assigner": "security-advisories@github.com",
  "Published": "2021-08-03T17:15:08.297Z",
  "Modified": "2022-07-02T16:28:32.41Z",
  "last-modified": "2022-07-02T16:28:32.41Z",
  "summary": "The npm package \"tar\" (aka node-tar) before versions 6.1.2, 5.0.7, 4.4.15, and 3.2.3 has an arbitrary File Creation/Overwrite vulnerability via insufficient symlink protection. `node-tar` aims to guarantee that any file whose location would be modified by a symbolic link is not extracted. This is, in part, achieved by ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary `stat` calls to determine whether a given path is a directory, paths are cached when directories are created. This logic was insufficient when extracting tar files that contained both a directory and a symlink with the same name as the directory. This order of operations resulted in the directory being created and added to the `node-tar` directory cache. When a directory is present in the directory cache, subsequent calls to mkdir for that directory are skipped. However, this is also where `node-tar` checks for symlinks occur. By first creating a directory, and then replacing that directory with a symlink, it was thus possible to bypass `node-tar` symlink checks on directories, essentially allowing an untrusted tar file to symlink into an arbitrary location and subsequently extracting arbitrary files into that location, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.3, 4.4.15, 5.0.7 and 6.1.2.",
  "access": {
    "authentication": "NONE",
    "complexity": "MEDIUM",
    "vector": "NETWORK"
  },
  "impact": {
    "availability": "PARTIAL",
    "confidentiality": "NONE",
    "integrity": "PARTIAL"
  },
  "cvss": 5.8,
  "exploitabilityScore": 8.6,
  "impactScore": 4.9,
  "cvss-vector": "AV:N/AC:M/Au:N/C:N/I:P/A:P",
  "references": [
    "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf",
    "https://github.com/npm/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20",
    "https://github.com/npm/node-tar/security/advisories/GHSA-r628-mhmh-qjhw",
    "https://www.npmjs.com/advisories/1771",
    "https://www.npmjs.com/package/tar",
    "https://www.oracle.com/security-alerts/cpuoct2021.html"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:a:tar_project:tar:0.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.16:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.17:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.18:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.19:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.20:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:1.0.1:-:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:a:tar_project:tar:0.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.16:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.17:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.18:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.19:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.20:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:1.0.1:-:*:*:*:*:*:*"
  ],
  "vendors": [
    "tar_project",
    "siemens"
  ],
  "products": [
    "tar",
    "sinec_infrastructure_network_services"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:a:tar_project:tar",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:a:tar_project:tar",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services"
  ],
  "cwe": "CWE-59",
  "vulnerable_configuration_cpe_2_2": []
}