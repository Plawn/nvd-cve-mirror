{
  "id": "CVE-2021-32804",
  "assigner": "security-advisories@github.com",
  "Published": "2021-08-03T17:15:08.41Z",
  "Modified": "2022-04-25T17:12:42.19Z",
  "last-modified": "2022-04-25T17:12:42.19Z",
  "summary": "The npm package \"tar\" (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14, and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient absolute path sanitization. node-tar aims to prevent extraction of absolute file paths by turning absolute paths into relative paths when the `preservePaths` flag is not set to `true`. This is achieved by stripping the absolute path root from any absolute file paths contained in a tar file. For example `/home/user/.bashrc` would turn into `home/user/.bashrc`. This logic was insufficient when file paths contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would only strip a single path root from such paths. When given an absolute file path with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would still resolve to an absolute path, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work around this vulnerability without upgrading by creating a custom `onentry` method which sanitizes the `entry.path` or a `filter` method which removes entries with absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803 which fixes a similar bug in later versions of tar.",
  "access": {
    "authentication": "NONE",
    "complexity": "MEDIUM",
    "vector": "NETWORK"
  },
  "impact": {
    "availability": "PARTIAL",
    "confidentiality": "NONE",
    "integrity": "PARTIAL"
  },
  "cvss": 5.8,
  "exploitabilityScore": 8.6,
  "impactScore": 4.9,
  "cvss-vector": "AV:N/AC:M/Au:N/C:N/I:P/A:P",
  "references": [
    "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf",
    "https://github.com/npm/node-tar/commit/1f036ca23f64a547bdd6c79c1a44bc62e8115da4",
    "https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9",
    "https://www.npmjs.com/advisories/1770",
    "https://www.npmjs.com/package/tar",
    "https://www.oracle.com/security-alerts/cpuoct2021.html"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:a:tar_project:tar:0.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.16:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.17:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.18:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.19:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.20:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:1.0.1:-:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:a:tar_project:tar:0.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.16:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.17:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.18:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.19:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:0.1.20:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:1.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:2.2.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.14:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.1.15:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:3.2.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.1.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.2.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.3.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.6:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.7:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.8:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.9:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.10:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.11:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.12:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:4.4.13:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:5.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.1:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.2:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.3:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.4:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.0.5:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:tar_project:tar:6.1.0:*:*:*:*:node.js:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services:1.0.1:-:*:*:*:*:*:*"
  ],
  "vendors": [
    "tar_project",
    "siemens"
  ],
  "products": [
    "tar",
    "sinec_infrastructure_network_services"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:a:tar_project:tar",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:a:tar_project:tar",
    "cpe:2.3:a:siemens:sinec_infrastructure_network_services"
  ],
  "cwe": "CWE-22",
  "vulnerable_configuration_cpe_2_2": []
}