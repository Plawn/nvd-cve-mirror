{
  "id": "CVE-2021-45046",
  "assigner": "security@apache.org",
  "Published": "2021-12-14T18:15:07.733Z",
  "Modified": "2022-10-06T00:54:26.84Z",
  "last-modified": "2022-10-06T00:54:26.84Z",
  "summary": "It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete in certain non-default configurations. This could allows attackers with control over Thread Context Map (MDC) input data when the logging configuration uses a non-default Pattern Layout with either a Context Lookup (for example, $${ctx:loginId}) or a Thread Context Map pattern (%X, %mdc, or %MDC) to craft malicious input data using a JNDI Lookup pattern resulting in an information leak and remote code execution in some environments and local code execution in all environments. Log4j 2.16.0 (Java 8) and 2.12.2 (Java 7) fix this issue by removing support for message lookup patterns and disabling JNDI functionality by default.",
  "access": {
    "authentication": "NONE",
    "complexity": "HIGH",
    "vector": "NETWORK"
  },
  "impact": {
    "availability": "PARTIAL",
    "confidentiality": "PARTIAL",
    "integrity": "PARTIAL"
  },
  "cvss": 5.1,
  "exploitabilityScore": 4.9,
  "impactScore": 6.4,
  "cvss-vector": "AV:N/AC:H/Au:N/C:P/I:P/A:P",
  "references": [
    "http://www.openwall.com/lists/oss-security/2021/12/14/4",
    "http://www.openwall.com/lists/oss-security/2021/12/15/3",
    "http://www.openwall.com/lists/oss-security/2021/12/18/1",
    "https://cert-portal.siemens.com/productcert/pdf/ssa-397453.pdf",
    "https://cert-portal.siemens.com/productcert/pdf/ssa-479842.pdf",
    "https://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf",
    "https://cert-portal.siemens.com/productcert/pdf/ssa-714170.pdf",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EOKPQGV24RRBBI4TBZUDQMM4MEH7MXCY/",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SIG7FZULMNK2XF6FZRU4VWYDQXNMUGAJ/",
    "https://logging.apache.org/log4j/2.x/security.html",
    "https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0032",
    "https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd",
    "https://www.cve.org/CVERecord?id=CVE-2021-44228",
    "https://www.debian.org/security/2021/dsa-5022",
    "https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00646.html",
    "https://www.kb.cert.org/vuls/id/930724",
    "https://www.oracle.com/security-alerts/alert-cve-2021-44228.html",
    "https://www.oracle.com/security-alerts/cpuapr2022.html",
    "https://www.oracle.com/security-alerts/cpujan2022.html",
    "https://www.oracle.com/security-alerts/cpujul2022.html"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:a:apache:log4j:2.0.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.0.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:rc3:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.4.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.10.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.10.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc3:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.3:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.3:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:opcenter_intelligence:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_4:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_7:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_7:2.20:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:vesys:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:sonicwall:email_security:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:sonicwall:email_security:10.0.9:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa12-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa22-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa32-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa42-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa52-0tp0_firmware:-:*:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:a:apache:log4j:2.0.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.0.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.1:rc3:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.3.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.4:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.4.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.5:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.6.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.7:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:*:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.8.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.9.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.10.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.10.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.11.2:rc3:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.12.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.1:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.2:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.2:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.3:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.13.3:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.1:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.14.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:-:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:a:apache:log4j:2.15.1:rc1:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:opcenter_intelligence:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_4:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_7:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:spectrum_power_7:2.20:*:*:*:*:*:*:*",
    "cpe:2.3:a:siemens:vesys:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:sonicwall:email_security:-:*:*:*:*:*:*:*",
    "cpe:2.3:a:sonicwall:email_security:10.0.9:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa12-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa22-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa32-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa42-0tp0_firmware:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:siemens:6bk1602-0aa52-0tp0_firmware:-:*:*:*:*:*:*:*"
  ],
  "vendors": [
    "apache",
    "siemens",
    "sonicwall"
  ],
  "products": [
    "log4j",
    "opcenter_intelligence",
    "spectrum_power_4",
    "spectrum_power_7",
    "vesys",
    "email_security",
    "6bk1602-0aa12-0tp0_firmware",
    "6bk1602-0aa22-0tp0_firmware",
    "6bk1602-0aa32-0tp0_firmware",
    "6bk1602-0aa42-0tp0_firmware",
    "6bk1602-0aa52-0tp0_firmware"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:a:apache:log4j",
    "cpe:2.3:a:siemens:opcenter_intelligence",
    "cpe:2.3:a:siemens:spectrum_power_4",
    "cpe:2.3:a:siemens:spectrum_power_7",
    "cpe:2.3:a:siemens:vesys",
    "cpe:2.3:a:sonicwall:email_security",
    "cpe:2.3:o:siemens:6bk1602-0aa12-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa22-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa32-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa42-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa52-0tp0_firmware"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:a:apache:log4j",
    "cpe:2.3:a:siemens:opcenter_intelligence",
    "cpe:2.3:a:siemens:spectrum_power_4",
    "cpe:2.3:a:siemens:spectrum_power_7",
    "cpe:2.3:a:siemens:vesys",
    "cpe:2.3:a:sonicwall:email_security",
    "cpe:2.3:o:siemens:6bk1602-0aa12-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa22-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa32-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa42-0tp0_firmware",
    "cpe:2.3:o:siemens:6bk1602-0aa52-0tp0_firmware"
  ],
  "cwe": "CWE-502",
  "vulnerable_configuration_cpe_2_2": []
}