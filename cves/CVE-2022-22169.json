{
  "id": "CVE-2022-22169",
  "assigner": "sirt@juniper.net",
  "Published": "2022-01-19T00:15:09.023Z",
  "Modified": "2022-02-01T19:01:41.813Z",
  "last-modified": "2022-02-01T19:01:41.813Z",
  "summary": "An Improper Initialization vulnerability in the routing protocol daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows an attacker who sends specific packets in certain orders and at specific timings to force OSPFv3 to unexpectedly enter graceful-restart (GR helper mode) even though there is not any Grace-LSA received in OSPFv3 causing a Denial of Service (DoS). Unexpectedly entering GR helper mode might cause the OSPFv3 neighbor adjacency formed on this interface to be stuck in the \"INIT\" state which can be observed by issuing the following command: user@device> show ospf3 neighbor ID Interface State xx.xx.xx.xx ae100.0 Init <<<<<<<<<< An indicator of compromise can be seen in log files when traceoptions for OSPFv3 are enabled before the issue occurs. These logfile messages are as follows: OSPF restart signaling: Received hello with LR bit set from nbr ip=xx::xx id=xx.xx.xx.xx. Set oob-resync capabilty 1. OSPF Restart Signaling: Start helper mode for nbr ip xx::xx id xx.xx.xx.xx OSPF restart signaling: abort helper mode for nbr ip=xx::xx id=xx.xx.xx.xx OSPF neighbor xx::xx (realm ipv6-unicast <interface.unit> area xx.xx.xx.xx) state changed from Full to Init due to 1WayRcvd (event reason: neighbor is in one-way mode) (nbr helped: 0) This issue affects: Juniper Networks Junos OS. 15.1 versions prior to 15.1R7-S11; 18.3 versions prior to 18.3R3-S6; 18.4 versions prior to 18.4R2-S9, 18.4R3-S10; 19.1 versions prior to 19.1R2-S3, 19.1R3-S7; 19.2 versions prior to 19.2R1-S7, 19.2R3-S4; 19.3 versions prior to 19.3R2-S7, 19.3R3-S4; 19.4 versions prior to 19.4R3-S6; 20.1 versions prior to 20.1R3-S1; 20.2 versions prior to 20.2R3-S3; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R2-S2, 20.4R3; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R1-S1, 21.2R2. This issue does not affect any version of Juniper Networks Junos OS 12.3. This issue affects Juniper Networks Junos OS Evolved all versions prior to 21.2R2-EVO.",
  "access": {
    "authentication": "NONE",
    "complexity": "MEDIUM",
    "vector": "NETWORK"
  },
  "impact": {
    "availability": "PARTIAL",
    "confidentiality": "NONE",
    "integrity": "NONE"
  },
  "cvss": 4.3,
  "exploitabilityScore": 8.6,
  "impactScore": 2.9,
  "cvss-vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "references": [
    "https://kb.juniper.net/JSA11276"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:o:juniper:junos_os_evolved:18.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s3:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:o:juniper:junos_os_evolved:18.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:19.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.2:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.3:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s4:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s5:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s1:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s2:*:*:*:*:*:*",
    "cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s3:*:*:*:*:*:*"
  ],
  "vendors": [
    "juniper"
  ],
  "products": [
    "junos_os_evolved"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:o:juniper:junos_os_evolved"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:o:juniper:junos_os_evolved"
  ],
  "cwe": "CWE-665",
  "vulnerable_configuration_cpe_2_2": []
}