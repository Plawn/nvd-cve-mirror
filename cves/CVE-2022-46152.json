{
  "id": "CVE-2022-46152",
  "assigner": "security-advisories@github.com",
  "Published": "2022-11-29T16:15:11.453Z",
  "Modified": "2022-12-02T17:45:48.457Z",
  "last-modified": "2022-12-02T17:45:48.457Z",
  "summary": "OP-TEE Trusted OS is the secure side implementation of OP-TEE project, a Trusted Execution Environment. Versions prior to 3.19.0, contain an Improper Validation of Array Index vulnerability. The function `cleanup_shm_refs()` is called by both `entry_invoke_command()` and `entry_open_session()`. The commands `OPTEE_MSG_CMD_OPEN_SESSION` and `OPTEE_MSG_CMD_INVOKE_COMMAND` can be executed from the normal world via an OP-TEE SMC. This function is not validating the `num_params` argument, which is only limited to `OPTEE_MSG_MAX_NUM_PARAMS` (127) in the function `get_cmd_buffer()`. Therefore, an attacker in the normal world can craft an SMC call that will cause out-of-bounds reading in `cleanup_shm_refs` and potentially freeing of fake-objects in the function `mobj_put()`. A normal-world attacker with permission to execute SMC instructions may exploit this flaw. Maintainers believe this problem permits local privilege escalation from the normal world to the secure world. Version 3.19.0 contains a fix for this issue. There are no known workarounds.",
  "access": {
    "authentication": null,
    "complexity": null,
    "vector": null
  },
  "impact": {
    "availability": null,
    "confidentiality": null,
    "integrity": null
  },
  "cvss": null,
  "exploitabilityScore": null,
  "impactScore": null,
  "cvss-vector": null,
  "references": [
    "https://github.com/OP-TEE/optee_os/blob/c2d449482de098f1c894b94f338440e5a327813d/core/tee/entry_std.c#L257",
    "https://github.com/OP-TEE/optee_os/commit/728616b28df659cf0bdde6e58a471f6ef25d023c",
    "https://github.com/OP-TEE/optee_os/security/advisories/GHSA-65w8-6mrg-52g7",
    "https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:U/RL:X/RC:X/CR:M/IR:M/AR:M/MAV:L/MAC:L/MPR:H/MUI:N/MS:C/MC:H/MI:H/MA:H&version=3.1"
  ],
  "vulnerable_configuration": [
    "cpe:2.3:o:op-tee:op-tee_os:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.1:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.6.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.1.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.2.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.4.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.5.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.6.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.7.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.7.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.8.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.8.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.9.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.9.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.10.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.10.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.11.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.11.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.12.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.12.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.13.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.13.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.14.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.14.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.15.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.15.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.16.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.16.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.17.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.17.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.18.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.18.0:rc1:*:*:*:*:*:*"
  ],
  "vulnerable_product": [
    "cpe:2.3:o:op-tee:op-tee_os:-:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:0.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.0.1:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:1.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.5.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:2.6.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.0.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.1.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.1.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.2.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.2.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.3.0:rc2:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.4.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.4.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.5.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.5.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.6.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.6.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.7.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.7.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.8.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.8.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.9.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.9.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.10.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.10.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.11.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.11.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.12.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.12.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.13.0:*:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.13.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.14.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.14.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.15.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.15.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.16.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.16.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.17.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.17.0:rc1:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.18.0:-:*:*:*:*:*:*",
    "cpe:2.3:o:op-tee:op-tee_os:3.18.0:rc1:*:*:*:*:*:*"
  ],
  "vendors": [
    "op-tee"
  ],
  "products": [
    "op-tee_os"
  ],
  "vulnerable_product_stems": [
    "cpe:2.3:o:op-tee:op-tee_os"
  ],
  "vulnerable_configuration_stems": [
    "cpe:2.3:o:op-tee:op-tee_os"
  ],
  "cwe": "CWE-129",
  "vulnerable_configuration_cpe_2_2": []
}